<!-- Modify it at your will. -->
<group name="vmware-esxi-syslog,">
  <rule id="111010" level="0">
    <decoded_as>vmware-esxi</decoded_as>
    <description>VMware ESXi syslogs grouped.</description>
  </rule>

  <!-- create new virtual machines -->
  <rule id="111011" level="5">
    <if_sid>111010</if_sid>
    <match>Created virtual machine</match>
    <description>VMware ESXi: Se creo una nueva VM: $(vm) en el host $(esxi_host).</description>
  </rule>

  <!-- virtual machines state changes -->
  <rule id="111012" level="3">
    <if_sid>111010</if_sid>
    <match>has powered on</match>
    <description>VMware ESXi: La VM: $(vm) se inicio en el host $(esxi_host).</description>
  </rule>

  <rule id="111013" level="10">
    <if_sid>111010</if_sid>
    <match>is powered off</match>
    <description>VMware ESXi: La VM: $(vm) se desconecto en el host $(esxi_host).</description>
  </rule>

  <rule id="111014" level="10">
    <if_sid>111010</if_sid>
    <match>Guest OS shut down</match>
    <description>VMware ESXi: La VM: $(vm) fue apagada en el host: $(esxi_host).</description>
  </rule>

  <rule id="111015" level="3">
    <if_sid>111010</if_sid>
    <match>Guest OS reboot</match>
    <description>VMware ESXi: La VM: $(vm) fue reiniciada en el host: $(esxi_host).</description>
  </rule>

  <!-- logins, logouts through web console, SSH and scripts -->
  <rule id="111016" level="8">
    <if_sid>111010</if_sid>
    <match>logged in</match>
    <description>VMware ESXi: El usuario: $(dstuser) con IP: $(srcip) inicio sesion en el host: $(esxi_host).</description>
  </rule>

  <rule id="111017" level="3">
    <if_sid>111010</if_sid>
    <match>logged out</match>
    <description>VMware ESXi: El usuario: $(dstuser) con IP: $(srcip) cerro sesion en el host: $(esxi_host).</description>
  </rule>

  <rule id="111018" level="10">
    <if_sid>111010</if_sid>
    <match>Cannot login</match>
    <description>VMware ESXi: ATENCION. Intento de inicio de sesion fallido por el usuario: $(dstuser) con IP: $(srcip) en el host: $(esxi_host).</description>
  </rule>

  <rule id="111019" level="11">
    <if_sid>111010</if_sid>
    <match>: SSH session was opened</match>
    <description>VMware ESXi: El usuario: $(dstuser) con IP: $(srcip) establecio una conexion SSH en el host: $(esxi_host).</description>
  </rule>

  <rule id="111020" level="14">
    <if_sid>111010</if_sid>
    <match>: SSH login has failed</match>
    <description>VMware ESXi: ATENCION. Intento de conexion SSH fallida por el usuario: $(dstuser) con IP: $(srcip) en el host: $(esxi_host).</description>
  </rule>

  <rule id="111021" level="3">
    <if_sid>111010</if_sid>
    <match>: SSH session was closed</match>
    <description>VMware ESXi: El usuario: $(dstuser) con IP: $(srcip) cerro una conexion SSH en el host: $(esxi_host).</description>
  </rule>

  <!-- datastore file upload, delete -->
  <rule id="111022" level="8">
    <if_sid>111010</if_sid>
    <match>File upload</match>
    <description>VMware ESXi: Se subio el archivo: $(path) en el host: $(esxi_host).</description>
  </rule>

  <rule id="111023" level="11">
    <if_sid>111010</if_sid>
    <match>Deletion of file or directory</match>
    <description>VMware ESXi: El archivo: $(path) en el disco: $(disk) fue eliminado del host: $(esxi_host).</description>
  </rule>

  <!-- virtual machine registration and removal -->
  <rule id="111024" level="5">
    <if_sid>111010</if_sid>
    <regex>Registered (\S+) on</regex>
    <description>VMware ESXi: Se registro una nueva VM: $(vm) en el host: $(esxi_host).</description>
  </rule>

  <rule id="111025" level="11">
    <if_sid>111010</if_sid>
    <regex>Removed (\S+) on</regex>
    <description>VMware ESXi: ATENCION. Se elimino la VM: $(vm) del host: $(esxi_host).</description>
  </rule>

  <!-- user create, modify and delete -->
  <rule id="111026" level="14">
    <if_sid>111010</if_sid>
    <regex>Account (\S+) was created</regex>
    <description>VMware ESXi: ATENCION. Se creo el usuario: $(dstuser) en el host: $(esxi_host).</description>
  </rule>

  <rule id="111027" level="14">
    <if_sid>111010</if_sid>
    <regex>Account (\S+) was removed</regex>
    <description>VMware ESXi: ATENCION. El usuario: $(dstuser) se elimino del host: $(esxi_host).</description>
  </rule>

  <rule id="111028" level="14">
    <if_sid>111010</if_sid>
    <match>Password was changed</match>
    <description>VMware ESXi: ATENCION. Se cambio la contraseña del usuario: $(dstuser) en el host: $(esxi_host).</description>
  </rule>

  <!-- shell commands -->
  <rule id="111029" level="8">
    <if_sid>111010</if_sid>
    <regex>shell[(\d+)]: [(\S+)]</regex>
    <description>VMware ESXi: El usuario: $(dstuser) ejecuto el comando: $(command) en la consola del host: $(esxi_host).</description>
  </rule>
  
  <rule id="111030" level="14">
    <if_sid>111029</if_sid>
    <match>python</match>
    <description>VMware ESXi: ATENCION. Ejecucion de Python por El usuario: $(dstuser) Comando: $(command) en el host: $(esxi_host).</description>
  </rule>
  
  <rule id="111031" level="15">
    <if_sid>111022</if_sid>
    <match>.py|.sh</match>
    <description>VMware ESXi: ATENCION. Se subio un archivo potencialmente peligroso en: $(path) en el host: $(esxi_host).</description>
  </rule>
  
  <rule id="111032" level="14">
    <if_sid>111029</if_sid>
    <match>mv</match>
    <description>VMware ESXi: ATENCION. Comando de renombramiento de archivos (mv) ejecutado por El usuario: $(dstuser) Comando: $(command) en el host: $(esxi_host).</description>
  </rule>
  vi test.py
  <rule id="111033" level="14">
    <if_sid>111029</if_sid>
    <regex>\.+.py</regex>
    <description>VMware ESXi: ATENCION. Se creó un archivo Python en el host: $(esxi_host). $(path)</description>
  </rule>
  <!--<rule id="111034" level="14">-->
  <!--  <if_sid>111029</if_sid>-->
  <!--  <field name="data.command">\.py</field>-->
  <!--  <description>VMware ESXi: ATENCION. Archivo Python detectado</description>-->
  <!--</rule>-->
  
  <rule id="111034" level="11">
    <if_sid>111010</if_sid>
    <match>PowerCLI</match>
    <description>VMware ESXi: El usuario: $(dstuser) con IP: $(srcip) establecio una conexion usando PowerCLI en el host: $(esxi_host).</description>
  </rule>
  
  <!--Test Desconexion PowerCLI mediante Proxy-->
  <!--<rule id="111035" level="11">-->
  <!--  <if_sid>111010</if_sid>-->
  <!--  <match>: logged in as PowerCLI</match>-->
  <!--  <description>VMware ESXi: El usuario: $(dstuser) con IP: $(srcip) establecio una conexion usando PowerCLI en el host: $(esxi_host).</description>-->
  <!--</rule>-->
  
</group>